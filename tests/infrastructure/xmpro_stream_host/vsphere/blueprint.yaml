node_templates:

  stream_host_vm:
    type: dell.nodes.ApplicationModule
    interfaces:
      dell.interfaces.lifecycle:
        start:
          implementation: tests/utilities/set_runtime_properties.py
          executor: central_deployment_agent
          inputs:
            capabilities:
              vm_host: 127.0.1.1
              vm_public_ip: 127.0.1.1
              vm_name: { get_input: hostname }
              vm_username: Administrator
              vm_winrm_port: 5985
        poststart:
          implementation: tests/utilities/verify_inputs.py
          executor: central_deployment_agent
          inputs:
            vsphere_secret_name:
              get_environment_capability: vcenter_credentials
            template_name:
              get_input: vm_template
            vm_name:
              get_input: hostname
            vm_user_name:
              get_input: vm_user_name
            vm_password_secret_name:
              get_input: vm_password_secret_name
            resource_pool_name:
              get_input: resource_pool_name
            vm_folder_name:
              get_input: vm_folder
            datastore_name:
              get_input: datastore_name
            allowed_esxi_hosts:
              get_input: allowed_esxi_host
            vcpu:
              get_input: vcpus
            memory_size:
              get_input: memory_size
            os_disk_size:
              get_input: os_disk_size
            disk_provisioning:
              get_input: disk_provisioning
            storage_disk_size:
              get_input: storage_disk_size
            disks_count:
              get_input: disks_count
            storage_disk_provisioning:
              get_input: storage_disk_provisioning
            networking:
              get_input: network_mappings
            pci_devices:
              get_input: pci_devices
            usb_devices:
              get_input: usb_devices
            serial_ports:
              get_input: serial_ports
            nics:
              get_input: nics_device_list
    relationships:
      - type: dell.relationships.depends_on
        target: validate_secrets
